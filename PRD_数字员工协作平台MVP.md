# Heliki OS 数字员工协作平台 MVP 产品需求文档

## 产品概述

### 产品定位
将Heliki OS从简单的Claude Code UI工具演进为数字员工协作平台，让小企业主能够"雇佣"和"管理"具备自主学习能力的数字员工团队。

### 核心价值主张
"让小企业主能够以极低成本雇佣一支具备无限学习能力的数字员工团队，实现7×24小时的智能化业务处理，并能根据业务需求自主获取新技能"

### MVP成功标准
- 用户开始用"我的xx员工"来称呼AI功能
- 用户能说出每个员工这周做了多少工作  
- 至少有一次AI主动完成了用户没有直接要求的任务

## 默认数字员工配置

### 1. 文档管理员
- **角色定义：** 专业的文件整理和管理专家
- **核心职责：** 自动整理/分类/重命名项目文件，清理AI产生的重复和临时文件，智能归档和版本管理，重要文档提醒和备份
- **工作价值：** "让文件井井有条，AI产生的冗余文件不再困扰"

### 2. 工作助理  
- **角色定义：** 贴身工作秘书和事务协调员
- **核心职责：** 制定每日/每周工作计划，协调任务分配，处理来访咨询和初级客户服务，提醒重要事项和截止日期
- **工作价值：** "像贴身秘书一样安排工作，协调团队"

### 3. 财务助理
- **角色定义：** 财务记录和风险分析专家
- **核心职责：** 拍照识别发票/收据并自动录入，生成财务报表和成本分析，识别财务风险和异常支出，税务提醒和合规检查
- **工作价值：** "多模态识别+风险预警，让财务透明可控"

### 4. 信息收集员
- **角色定义：** 信息获取和分析专家  
- **核心职责：** 根据用户设定目标收集相关信息，监控行业动态和竞品信息，关联公众号、网站进行定向推送，信息价值评估和重要性排序
- **工作价值：** "主动筛选有价值信息，关联推送"

### 5. 全栈工程师
- **角色定义：** 技术问题解决和应用开发专家
- **核心职责：** 根据业务需求开发小工具和应用，解决其他智能体遇到的技术问题，系统集成和API开发，自动化脚本编写
- **工作价值：** "按需开发应用，解决技术问题"

## MVP功能实现路线图

### 第一阶段：基础员工系统 (2-3周)

#### 1.1 默认智能体自动部署 ⭐⭐⭐⭐⭐
**功能描述：** 系统启动时自动创建5个默认agent的markdown配置文件

**技术实现：**
- 扩展 `projects_manager.py` 添加agents管理功能
- 在应用启动时检查 `~/.claude/agents/` 目录
- 如果目录为空，自动创建5个默认agent的markdown文件
- 集成到现有的环境检测机制中

**验收标准：**
- 首次启动系统时，`~/.claude/agents/` 目录自动创建5个agent文件
- 每个agent文件包含正确的YAML前置内容和角色描述
- 环境检测页面显示"数字员工团队已就绪"

**技术风险：** 低
**用户价值：** 高 - 开箱即用，立即拥有专业团队

#### 1.2 员工身份可视化 ⭐⭐⭐⭐⭐
**功能描述：** 在侧边栏显示数字员工团队，让用户看到"雇佣了5个员工"

**技术实现：**
- 扩展侧边栏组件 `sidebar.js` 
- 读取agents目录，解析markdown文件的YAML前置内容
- 在侧边栏添加"员工团队"区域
- 显示每个员工的名称、角色、状态、专业技能

**验收标准：**
- 侧边栏显示"我的数字员工"区域
- 列出5个员工，每个显示：名称、角色、在线状态、专业技能标签
- 点击员工可查看详细信息（职责描述、工作历史）
- 支持员工状态实时更新

**技术风险：** 低
**用户价值：** 高 - 心理模式从"工具使用者"转为"团队管理者"

**依赖：** 1.1 默认智能体自动部署

### 第二阶段：用户设定任务系统 (2-3周) 🔥
**阶段目标：** 让用户能够设定和管理数字员工的工作任务，体验"雇佣员工干活"的核心价值

#### 2.1 每日任务管理界面 ⭐⭐⭐⭐⭐
**功能描述：** 将system-status-btn改造为任务管理入口，提供直观的任务设定界面

**界面原型设计：**
- 替换侧边栏system-status-btn为"每日任务"按钮
- 点击弹出任务管理模态框，显示已设置任务列表
- 支持任务的启用/禁用/编辑/删除操作
- 显示任务状态：上次执行时间、执行结果等

**技术实现：**
- 创建TaskManagerModal.js组件替换原system-status按钮
- 设计任务数据结构：任务名称、目标、资源、执行方式、状态
- 实现任务本地存储和状态管理
- 提供任务CRUD的API接口

**验收标准：**
- 侧边栏显示"每日任务"按钮，替代原系统状态按钮
- 点击后弹出任务管理界面，显示任务列表
- 支持查看任务详情、修改任务状态
- 界面响应快速，操作直观易用

**技术风险：** 低 - 基于现有界面框架扩展
**用户价值：** 高 - 提供直观的员工任务管理体验

**依赖：** 1.2 员工身份可视化

#### 2.2 新增任务表单 ⭐⭐⭐⭐⭐
**功能描述：** 提供完整的任务创建表单，支持任务目标、资源选择、权限设置等配置

**界面原型设计：**
- 任务名称输入框
- 任务目标描述文本域（支持多行输入）
- 权限设置：--dangerously-skip-permissions选项复选框
- 资源文件选择：支持文件浏览器、拖拽、手动路径输入
- 执行方式：立即执行 vs 定时执行（单选）
- 定时设置：时间选择器（如选择定时执行）

**技术实现：**
- 创建TaskForm.js组件处理任务表单
- 创建ResourceSelector.js组件处理资源文件选择
- 集成Claude Code的文件添加机制：直接路径、@server:resource语法
- 表单验证和数据格式化
- 与任务管理模态框集成

**验收标准：**
- 表单界面美观易用，支持所有必要的配置项
- 资源选择支持多种方式：浏览、拖拽、手动输入
- 表单验证完整，防止无效数据提交
- 与Claude Code文件系统良好集成
- 支持任务预览和编辑功能

**技术风险：** 中 - 资源文件选择的复杂性和Claude Code集成
**用户价值：** 高 - 提供完整的任务配置体验

**依赖：** 2.1 每日任务管理界面

#### 2.3 任务执行与调度系统 ⭐⭐⭐⭐⭐
**功能描述：** 实现任务的执行调度，支持立即执行和定时执行，集成现有页签系统

**技术实现：**
- 创建TaskScheduler.py实现任务调度逻辑
- 使用Python schedule库实现简单的定时任务
- 任务执行时创建新页签，复用现有Claude CLI集成
- 页签标题格式：📋 [任务名称]
- 通过WebSocket通知前端开启任务页签
- 任务执行状态管理：待执行、执行中、已完成、失败

**页签集成策略：**
- 任务执行页签与项目页签使用相同的界面和交互
- 用户可以像查看项目一样查看任务进度和结果
- 任务完成后页签保留，用户可以查看执行历史
- 支持任务页签的关闭、重新执行等操作

**验收标准：**
- 支持立即执行和定时执行两种模式
- 任务执行时自动创建对应页签，标题清晰标识
- 页签内容为标准Claude CLI界面，显示执行过程
- 定时任务能按设定时间自动执行
- 任务状态准确跟踪，执行日志完整

**技术风险：** 中 - 定时任务的稳定性和页签系统集成
**用户价值：** 极高 - 核心功能实现，让用户真正体验到员工执行任务

**依赖：** 2.2 新增任务表单

### 第三阶段：工作成果跟踪 (2-3周) 📊
**阶段目标：** 让用户看到"员工的具体贡献"

#### 3.1 基础工作统计 ⭐⭐⭐⭐⭐
**功能描述：** 追踪和统计每个智能体完成的工作量

**技术实现：**
- 扩展 `claude_cli.py` 添加日志解析功能
- 解析Claude CLI的输出日志，识别完成的任务类型
- 按agent分类统计：文件操作数、代码生成行数、处理时长、token消耗
- 在内存中维护工作统计数据
- 提供统计数据的API接口

**验收标准：**
- 能够识别并统计各种工作类型：文件操作、代码生成、问题解答等
- 按agent分类记录工作量，包含时间戳
- 统计数据包含：今日任务数、本周任务数、累计token消耗
- 提供工作历史查询功能

**技术风险：** 中 - 日志解析的复杂度和准确性
**用户价值：** 高 - ROI可视化，工作成果量化

**依赖：** 2.3 基础工作通知

#### 3.2 工作仪表板 ⭐⭐⭐⭐☆
**功能描述：** 可视化显示数字员工团队的工作统计和成果

**技术实现：**
- 创建新的仪表板页面组件 `employee_dashboard.js`
- 显示团队总体工作统计：今日/本周工作量、token消耗、任务完成率
- 显示每个员工的工作详情：专业技能、完成任务、效率排名
- 通过WebSocket实时更新统计数据
- 支持时间范围筛选（今日/本周/本月）

**验收标准：**
- 仪表板显示团队工作概览：总任务数、总token消耗、活跃员工数
- 每个员工显示：头像、姓名、今日工作量、本周趋势、技能标签
- 支持实时数据刷新，工作完成时立即更新统计
- 提供简单的数据可视化（进度条、趋势图）

**技术风险：** 低
**用户价值：** 高 - 强化管理者体验，工作成果可视化

**依赖：** 3.1 基础工作统计

#### 3.3 工作报告生成 ⭐⭐⭐☆☆
**功能描述：** 数字员工定期汇报工作进展

**技术实现：**
- 基于定时任务和工作统计数据
- 定时汇总各员工的工作情况（每日/每周）
- 生成结构化的工作报告：完成任务、遇到问题、建议改进
- 通过WebSocket推送报告到前端，或保存为文档
- 支持报告模板自定义和导出功能

**验收标准：**
- 每日/每周自动生成团队工作报告
- 报告内容包含：各员工工作量、重要成果、异常情况
- 支持报告查看、下载和分享
- 用户可以设定报告频率和内容偏好

**技术风险：** 低
**用户价值：** 中 - 管理体验增强

**依赖：** 3.2 工作仪表板

### 第四阶段：技能扩展能力 (2-3周) 🔧
**阶段目标：** 让用户感受到"员工在学习新技能"

#### 4.1 MCP工具推荐 ⭐⭐⭐☆☆
**功能描述：** 智能体发现需要新工具时主动推荐

**技术实现：**
- 扩展Claude CLI集成，监控输出日志
- 识别工具不足的情况（如"需要访问数据库"、"需要发送邮件"）
- 建立MCP服务器推荐数据库，匹配需求和可用工具
- 在界面提示用户安装建议的工具
- 记录工具推荐历史和用户反馈

**验收标准：**
- 自动识别智能体的工具需求
- 推荐相关的MCP服务器，包含功能描述和安装说明
- 用户可以查看推荐历史和安装状态
- 支持工具推荐的用户反馈和评分

**技术风险：** 中 - 智能推荐算法的准确性
**用户价值：** 中 - 员工技能扩展

**依赖：** 3.3 工作报告生成

#### 4.2 一键工具安装 ⭐⭐☆☆☆
**功能描述：** 用户确认后自动安装推荐的MCP服务器

**技术实现：**
- 用户确认后执行 `claude mcp add` 命令
- 监控安装进度和结果
- 安装成功后更新相关agents配置，包含新工具
- 通知相关员工已获得新技能
- 提供工具管理界面：查看、启用、禁用已安装工具

**验收标准：**
- 一键安装推荐的MCP服务器
- 安装过程可视化，显示进度和状态
- 安装完成后相关员工自动获得新技能
- 支持工具的启用/禁用管理

**技术风险：** 低
**用户价值：** 中 - 用户体验优化

**依赖：** 4.1 MCP工具推荐

## 调整后的开发路径说明

### **路径调整理由**

**为什么改为用户设定任务系统？**
1. **降低技术复杂度：** 从AI主动感知改为用户主动设置，避免复杂的环境监控和判断逻辑
2. **用户完全可控：** 用户明确知道设置了什么任务，避免AI误判执行不需要的操作
3. **快速验证价值：** 先让用户体验到"员工执行任务"的核心价值，再考虑智能化
4. **复用现有架构：** 基于现有页签和Claude CLI系统，技术风险可控

**为什么工作统计推到第三阶段？**
1. **需要有任务执行数据：** 用户设定并执行任务后，才有统计和跟踪的基础数据
2. **先跑通核心流程：** 确保任务创建和执行的完整流程稳定后，再添加统计功能
3. **渐进式用户体验：** 先让用户体验"管理员工干活"，再提供"查看工作成果"

### **各阶段核心目标**
- **第一阶段：** 让用户看到"雇佣了数字员工团队" 
- **第二阶段：** 让用户能够"设定任务并看到员工执行"的核心价值 🔥
- **第三阶段：** 让用户看到"员工的具体贡献" 📊
- **第四阶段：** 让用户感受到"员工在学习新技能" 🔧

## 技术架构说明

### 现有架构基础
- ✅ Claude CLI集成和WebSocket通信 (`claude_cli.py`, `websocket.js`)
- ✅ 项目管理和文件树浏览 (`projects_manager.py`, `file_tree.js`)
- ✅ 基础Web界面框架 (`app.py`, `sidebar.js`)
- ✅ 环境检测和错误处理 (`EnvironmentChecker`)

### 新增核心模块
- **Agent管理器：** 管理默认智能体的创建、配置和状态
- **工作统计器：** 解析日志，统计各员工工作量
- **任务调度器：** 支持定时任务和文件监控触发
- **工具管理器：** MCP服务器推荐和安装管理

### 用户界面调整
- **重点维护终端形态：** 专注于shell交互，暂停chat.js维护
- **侧边栏扩展：** 添加员工团队展示区域
- **新增仪表板：** 工作统计和成果可视化
- **任务管理界面：** 定时任务配置和监控

## 风险评估

### 高风险项目
- **定时任务框架：** 可能影响现有架构稳定性，需要充分测试

### 中风险项目  
- **文件监控系统：** 性能和稳定性需要验证
- **日志解析统计：** 准确性和复杂度需要控制
- **MCP工具检测：** 推荐算法的准确性

### 低风险项目
- **文件操作类功能：** 基于现有能力扩展
- **前端界面扩展：** 基于现有组件开发

## 开发优先级说明

**必做功能 (⭐⭐⭐⭐⭐)：**
- 默认智能体部署和身份可视化
- 工作成果统计和追踪
- 定时任务框架

**重要功能 (⭐⭐⭐⭐☆)：**
- 工作仪表板
- 文件监控系统

**可选功能 (⭐⭐⭐☆☆及以下)：**
- 工作报告生成
- MCP工具推荐和安装

## 验收和测试

### 功能测试
- 每个功能模块独立测试通过
- 模块间集成测试验证
- 用户场景端到端测试

### 用户体验测试
- 5名小企业主进行产品试用
- 收集"员工感知"和"管理体验"反馈
- 验证MVP成功标准达成情况

### 性能测试
- 定时任务系统稳定性测试
- 文件监控系统性能测试
- WebSocket并发连接测试

## 开发路径：
  - 第一阶段 (2-3周): 智能体部署 + 身份可视化
  - 第二阶段 (2-3周): 用户设定任务系统 + 执行调度
  - 第三阶段 (2-3周): 工作统计 + 仪表板 + 工作报告  
  - 第四阶段 (2-3周): MCP工具推荐 + 一键安装
---

**文档版本：** V1.0  
**创建时间：** 2025-01-08  
**更新时间：** 2025-01-08  
**责任人：** Heliki OS 开发团队